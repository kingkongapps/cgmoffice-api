<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace='api.common.auth'>

	<select id="getUserAuthList"
		parameterType="string"
		resultType="string"
	>
	/* api.common.auth.getUserAuthList */
		SELECT
			authority
		FROM user_authority
		WHERE 1=1
			AND username = #{username}
	</select>

	<insert id="insertLoginLog"
		parameterType="cmmnMap"
	>
	/* api.common.auth.insertLoginLog */
		INSERT INTO TB_LGN_LST (
			LGN_SEQ
			,MEM_ID
			,ACS_DT
			,ACS_IP
			,LGN_SCS_YN
			,LOGIN_CFCD
			,DEL_YN
			,CRT_DTM
			,MDF_DTM
			,CRTR
			,AMDR
		) VALUES (
			( SELECT (COALESCE( MAX(A.LGN_SEQ), 0) + 1 ) FROM  TB_LGN_LST A )
			,#{MEM_ID}
			,#{ACS_DT}
			,#{ACS_IP}
			,#{LGN_SCS_YN}
			,#{LOGIN_CFCD}
			,'N'
			,CURRENT_TIMESTAMP
			,CURRENT_TIMESTAMP
			,#{CRTR}
			,#{AMDR}
		)
	</insert>

	<select id="getFindAcYn_TB_MEM"
		parameterType="string"
		resultType="com.cgmoffice.api.common.dto.UserDto"
	>
	/* api.common.auth.getFindAcYn_TB_MEM */
		SELECT
			 MEM_ID
			,FIND_AC_YN
		FROM TB_MEM
		WHERE 1=1
			AND MEM_ID = #{memId}
	</select>

</mapper>